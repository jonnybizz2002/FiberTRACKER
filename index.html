<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frontier Sales Tracker</title>

<style>
body { font-family: Arial; background:#f4f6f8; padding:15px; }
h1 { text-align:center; color:#007bff; }
form, table { background:#fff; padding:15px; border-radius:8px; margin-bottom:15px; }
input, select, button { width:100%; padding:8px; margin-top:5px; }
button { background:#007bff; color:#fff; border:none; border-radius:5px; margin-top:10px; }
table { width:100%; border-collapse:collapse; }
th, td { border:1px solid #ccc; padding:6px; text-align:center; }
th { background:#007bff; color:#fff; }
.pending { background:#fff3cd; }
.installed { background:#d4edda; }
.canceled { background:#f8d7da; }
.confirmed { background:#d4edda; }
.unconfirmed { background:#f8d7da; }
.small { font-size:12px; }
</style>
</head>

<body>

<h1>Frontier Fiber Sales</h1>

<form id="saleForm">
  <label>Name</label>
  <input id="name">

  <label>Phone</label>
  <input id="phone">

  <label>BTN</label>
  <input id="btn">

  <label>Speed</label>
  <select id="speed">
    <option value="">Select</option>
    <option>500 Mbps</option>
    <option>1 Gig</option>
    <option>2 Gig</option>
  </select>

  <label>Date Sold</label>
  <input type="date" id="dateSold">

  <label>Install Date</label>
  <input type="date" id="installDate">

  <button type="button" onclick="addSale()">Add Sale</button>
</form>

<table>
<thead>
<tr>
<th>Name</th>
<th>Phone</th>
<th>BTN</th>
<th>Speed</th>
<th>Date Sold</th>
<th>Install</th>
<th>Confirmed</th>
<th>Status</th>
<th>Delete</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<button onclick="exportCSV()">Export CSV</button>

<script>
let sales = JSON.parse(localStorage.getItem("sales") || "[]");

function save(){ localStorage.setItem("sales", JSON.stringify(sales)); }

function format(d){
  if(!d) return "";
  let p=d.split("-");
  return p[1]+"/"+p[2]+"/"+p[0].slice(2);
}

function addSale(){
  let name=document.getElementById("name").value.trim();
  if(!name){ alert("Name required"); return; }

  sales.push({
    name,
    phone:phone.value,
    btn:btn.value,
    speed:speed.value,
    dateSold:dateSold.value,
    installDate:installDate.value,
    confirmed:false,
    status:"Pending"
  });

  save();
  saleForm.reset();
  render();
}

function cycleStatus(i){
  let s=sales[i];
  s.status = s.status==="Pending"
    ? "Installed"
    : s.status==="Installed"
    ? "Canceled"
    : "Pending";
  save(); render();
}

function toggleConfirmed(i){
  sales[i].confirmed = !sales[i].confirmed;
  save(); render();
}

function delSale(i){
  sales.splice(i,1);
  save(); render();
}

function render(){
  tableBody.innerHTML="";
  sales.forEach((s,i)=>{
    let tr=document.createElement("tr");
    tr.className = s.status.toLowerCase();

    tr.innerHTML=`
      <td contenteditable oninput="sales[${i}].name=this.innerText;save()">${s.name}</td>
      <td contenteditable oninput="sales[${i}].phone=this.innerText;save()">${s.phone}</td>
      <td contenteditable oninput="sales[${i}].btn=this.innerText;save()">${s.btn}</td>
      <td contenteditable oninput="sales[${i}].speed=this.innerText;save()">${s.speed}</td>
      <td>${format(s.dateSold)}</td>
      <td>${format(s.installDate)}</td>
      <td>
        <button class="small ${s.confirmed?'confirmed':'unconfirmed'}"
                onclick="toggleConfirmed(${i})">
          ${s.confirmed?'Confirmed':'Unconfirmed'}
        </button>
      </td>
      <td>
        <button class="small" onclick="cycleStatus(${i})">${s.status}</button>
      </td>
      <td>
        <button onclick="delSale(${i})">X</button>
      </td>
    `;
    tableBody.appendChild(tr);
  });
}

function exportCSV(){
  let csv="Name,Phone,BTN,Speed,Date Sold,Install Date,Confirmed,Status\n";
  sales.forEach(s=>{
    csv+=`"${s.name}","${s.phone}","${s.btn}","${s.speed}","${format(s.dateSold)}","${format(s.installDate)}","${s.confirmed?'Yes':'No'}","${s.status}"\n`;
  });
  let a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="frontier_sales.csv";
  a.click();
}

render();
</script>

</body>
</html>
